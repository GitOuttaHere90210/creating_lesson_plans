<!DOCTYPE html>
<html>
<head>
    <title>UFLI Lesson 10 PPT Generator</title>
    <meta charset="UTF-8">
    <script src="https://gitouttahere90210.github.io/creating_lesson_plans/pptxgen.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
            background-color: #f0f0f0;
        }
        h1 { color: #333; }
        button {
            padding: 10px 20px;
            font-size: 16px;
            margin: 10px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .error { color: red; margin: 10px; display: none; }
        .loading { color: blue; margin: 10px; }
        #errorLog {
            color: red;
            font-size: 14px;
            max-width: 600px;
            margin: 10px auto;
            text-align: left;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>UFLI Lesson 10: Short I (/ĭ/) Materials</h1>
    <p>Click the buttons to generate and download PPTX files.</p>
    <div id="loading" class="loading">Loading PptxGenJS library...</div>
    <div id="error" class="error">
        Error: PptxGenJS failed to load. Ensure 'pptxgen.min.js' is accessible at https://gitouttahere90210.github.io/creating_lesson_plans/pptxgen.min.js. Check console (F12 > Console) for details.
    </div>
    <div id="errorLog"></div>
    <button id="testBtn" onclick="testLibrary()" disabled>Test PptxGenJS</button>
    <button id="slidesBtn" onclick="generateSlides()" disabled>Download Slides PPT</button>
    <button id="cardsBtn" onclick="generateWordCards()" disabled>Download Word Cards PPT</button>
    <button id="tilesBtn" onclick="generateLetterTiles()" disabled>Download Letter Tiles PPT</button>

    <script>
        // Error logging function
        function logError(message) {
            console.error(message);
            document.getElementById('errorLog').innerText += message + '\n';
        }

        // Check if PptxGenJS is loaded
        function checkLibraryLoaded() {
            if (typeof PptxGenJS === 'undefined') {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
                logError('PptxGenJS not loaded. Verify "pptxgen.min.js" is accessible at https://gitouttahere90210.github.io/creating_lesson_plans/pptxgen.min.js. Check console (F12).');
                return false;
            }
            document.getElementById('loading').style.display = 'none';
            document.getElementById('testBtn').disabled = false;
            document.getElementById('slidesBtn').disabled = false;
            document.getElementById('cardsBtn').disabled = false;
            document.getElementById('tilesBtn').disabled = false;
            return true;
        }

        // Test PptxGenJS
        function testLibrary() {
            if (!checkLibraryLoaded()) return;
            try {
                let pptx = new PptxGenJS();
                alert('PptxGenJS loaded successfully! Version: ' + pptx.version);
            } catch (e) {
                logError('Test error: ' + e.message);
            }
        }

        // Generate Slides
        function generateSlides() {
            if (!checkLibraryLoaded()) return;
            try {
                let pptx = new PptxGenJS();
                pptx.layout = 'LAYOUT_4x3';
                pptx.theme = { backgroundColor: 'C8DCFF' };

                // Slide 1: Title
                let slide1 = pptx.addSlide();
                slide1.addText('Lesson 10: Short I (/ĭ/) - CVC Words', { x: 0.5, y: 0.5, w: 9, fontSize: 36, bold: true, fontFace: 'Arial' });
                slide1.addText('Unit 1: Alphabet | Day 1: Steps 1-5, Day 2: Steps 5-8', { x: 0.5, y: 1.5, w: 9, fontSize: 20 });
                slide1.addText('Image: Cartoon igloo (center)', { x: 0.5, y: 2.5, w: 9, fontSize: 16, italic: true });
                slide1.addText('Notes: Welcome students; preview lesson focus.', { x: 0.5, y: 4.5, w: 9, fontSize: 14 });

                // Slide 2: Phonemic Awareness
                let slide2 = pptx.addSlide();
                slide2.addText('Phonemic Awareness Warm-Up (Step 1)', { x: 0.5, y: 0.5, w: 9, fontSize: 24, bold: true });
                slide2.addText([
                    { text: '• Blend: /p/ /ĭ/ /t/ → "pit"', options: { bullet: true } },
                    { text: '• Blend: /s/ /ĭ/ /p/ → "sip"', options: { bullet: true } },
                    { text: '• Segment: "sit" → /s/ /ĭ/ /t/', options: { bullet: true } },
                    { text: '• Segment: "tip" → /t/ /ĭ/ /p/', options: { bullet: true } }
                ], { x: 0.5, y: 1.5, w: 9, fontSize: 18 });
                slide2.addText('Notes: Teacher models; students echo chorally.', { x: 0.5, y: 4.5, w: 9, fontSize: 14 });

                // Slide 3: Visual Drill
                let slide3 = pptx.addSlide();
                slide3.addText('Visual Drill: Letter Sounds (Step 2)', { x: 0.5, y: 0.5, w: 9, fontSize: 24, bold: true });
                slide3.addText('m (monkey: /m/)\ts (snake: /s/)\ta (apple: /ă/)\nt (tiger: /t/)\tp (pig: /p/)\ti (igloo: /ĭ/)', { x: 0.5, y: 1.5, w: 9, fontSize: 18, align: 'center' });
                slide3.addText('Notes: Students say "[letter] spells /sound/." Flash each for 3 sec.', { x: 0.5, y: 4.5, w: 9, fontSize: 14 });

                // Slide 4: Auditory Drill
                let slide4 = pptx.addSlide();
                slide4.addText('Auditory Drill: Write the Sound (Step 3)', { x: 0.5, y: 0.5, w: 9, fontSize: 24, bold: true });
                slide4.addText([
                    { text: '• /ĭ/ → Write "i" (/ĭ/ is i)', options: { bullet: true } },
                    { text: '• /m/ → Write "m"', options: { bullet: true } },
                    { text: '• /s/ → Write "s"', options: { bullet: true } },
                    { text: '• /t/ → Write "t"', options: { bullet: true } },
                    { text: '• /p/ → Write "p"', options: { bullet: true } },
                    { text: '• /ă/ → Write "a"', options: { bullet: true } }
                ], { x: 0.5, y: 1.5, w: 9, fontSize: 18 });
                slide4.addText('Notes: Students write on whiteboards; check formations.', { x: 0.5, y: 4.5, w: 9, fontSize: 14 });

                // Slide 5: Blending Drill
                let slide5 = pptx.addSlide();
                slide5.addText('Blending Drill: Word Chains (Step 4)', { x: 0.5, y: 0.5, w: 9, fontSize: 24, bold: true });
                slide5.addText('Chain 1: sip → tip → tap → sap\nChain 2: pit → pat → sat → sit', { x: 0.5, y: 1.5, w: 9, fontSize: 18, align: 'center' });
                slide5.addText('Notes: Choral read with Blending Board App or cards.', { x: 0.5, y: 4.5, w: 9, fontSize: 14 });

                // Slide 6: New Concept
                let slide6 = pptx.addSlide();
                slide6.addText('Introducing Short I (/ĭ/) (Step 5, Day 1)', { x: 0.5, y: 0.5, w: 9, fontSize: 24, bold: true });
                slide6.addText('Keyword: Igloo (/ĭ/) – Clipped tongue sound.\nFormation: "i" (line down, dot on top).\nRead Words: it, sip, pit, tip, sit, mitt, hit, lip', { x: 0.5, y: 1.5, w: 9, fontSize: 18 });
                slide6.addText('Notes: Choral read; use Elkonin boxes for spelling.', { x: 0.5, y: 4.5, w: 9, fontSize: 14 });

                // Slide 7: Review & Word Work
                let slide7 = pptx.addSlide();
                slide7.addText('Review & Word Work (Steps 5-6, Day 2)', { x: 0.5, y: 0.5, w: 9, fontSize: 24, bold: true });
                slide7.addText('Quick Review: sip, pit, tip, sit\nChains: sip → tip → tap → sap; pit → pat → sat → sit\nRoll & Read: it, sip, pit, tip, sit, mitt, hit, lip, dip, rip, nip, zip, fit, kit, bit, lit', { x: 0.5, y: 1.5, w: 9, fontSize: 18 });
                slide7.addText('Notes: Use letter tiles for manipulation.', { x: 0.5, y: 4.5, w: 9, fontSize: 14 });

                // Slide 8: Irregular Words
                let slide8 = pptx.addSlide();
                slide8.addText('Heart Words: Irregulars (Step 7)', { x: 0.5, y: 0.5, w: 9, fontSize: 24, bold: true });
                slide8.addText([
                    { text: '• the (/TH/ē/ – irregular vowel)', options: { bullet: true } },
                    { text: '• of (/ŭv/ – irregular spelling)', options: { bullet: true } },
                    { text: '• a (/ă/ – review)', options: { bullet: true } },
                    { text: '• I (/ī/ – review)', options: { bullet: true } }
                ], { x: 0.5, y: 1.5, w: 9, fontSize: 18 });
                slide8.addText('Notes: Highlight irregular parts; arm-tap spelling.', { x: 0.5, y: 4.5, w: 9, fontSize: 14 });

                // Slide 9: Connected Text Sentences
                let slide9 = pptx.addSlide();
                slide9.addText('Fluent Reading: Sentences (Step 8)', { x: 0.5, y: 0.5, w: 9, fontSize: 24, bold: true });
                slide9.addText('1. I sit and sip.\n2. The pit is big.\nDictation: Write: I sip it.', { x: 0.5, y: 1.5, w: 9, fontSize: 18 });
                slide9.addText('Notes: Choral read 2-3 times; discuss punctuation.', { x: 0.5, y: 4.5, w: 9, fontSize: 14 });

                // Slide 10: Connected Text Passage
                let slide10 = pptx.addSlide();
                slide10.addText('Decodable Passage: Sip and Sit (Step 8)', { x: 0.5, y: 0.5, w: 9, fontSize: 24, bold: true });
                slide10.addText('Tim has a big pit. The pit is for pigs. A pig sits in it. "I sip it," said Tim. The pig tips it. Sip, sip, sip. The pig is big. Tim sits with it.', { x: 0.5, y: 1.5, w: 9, fontSize: 18 });
                slide10.addText('Notes: Guided reading; highlight decodable words.', { x: 0.5, y: 4.5, w: 9, fontSize: 14 });

                pptx.writeFile({ fileName: 'UFLI_Lesson_10_Slides.pptx' });
            } catch (e) {
                logError('Slides generation error: ' + e.message);
            }
        }

        // Generate Word Cards
        function generateWordCards() {
            if (!checkLibraryLoaded()) return;
            try {
                let pptx = new PptxGenJS();
                pptx.layout = 'LAYOUT_4x3';
                let words = ['it', 'sip', 'pit', 'tip', 'sit', 'mitt', 'hit', 'lip', 'dip', 'rip', 'nip', 'zip', 'fit', 'kit', 'bit', 'lit', 'the', 'of', 'a', 'I'];

                words.forEach(word => {
                    // Front of card (4x6 inches, centered on slide)
                    let slideFront = pptx.addSlide();
                    slideFront.addText(word, {
                        x: 3, y: 0.5, w: 4, h: 6,
                        fontSize: 48, fontFace: 'Arial',
                        align: 'center', valign: 'middle',
                        fill: { color: 'FFFFFF' },
                        border: { pt: 2, color: '000000' }
                    });

                    // Back of card (placeholder for teacher notes or blank)
                    let slideBack = pptx.addSlide();
                    slideBack.addText(`Back of "${word}" card`, {
                        x: 3, y: 0.5, w: 4, h: 6,
                        fontSize: 24, fontFace: 'Arial',
                        align: 'center', valign: 'middle',
                        fill: { color: 'F0F0F0' },
                        border: { pt: 2, color: '000000' }
                    });
                });

                pptx.writeFile({ fileName: 'UFLI_Lesson_10_Word_Cards.pptx' });
            } catch (e) {
                logError('Word cards generation error: ' + e.message);
            }
        }

        // Generate Letter Tiles
        function generateLetterTiles() {
            if (!checkLibraryLoaded()) return;
            try {
                let pptx = new PptxGenJS();
                pptx.layout = 'LAYOUT_4x3';
                let letters = ['i', 'i', 'm', 'm', 's', 's', 't', 't', 'p', 'p', 'a', 'a'];

                // Place 4 tiles per slide (2x2 grid, 2x2 inches each)
                let slide = null;
                let positions = [
                    { x: 1, y: 1 }, { x: 4, y: 1 },
                    { x: 1, y: 4 }, { x: 4, y: 4 }
                ];
                let posIndex = 0;

                letters.forEach((letter, index) => {
                    if (index % 4 === 0) {
                        slide = pptx.addSlide();
                        posIndex = 0;
                    }
                    slide.addText(letter, {
                        x: positions[posIndex].x, y: positions[posIndex].y, w: 2, h: 2,
                        fontSize: 36, fontFace: 'Arial',
                        align: 'center', valign: 'middle',
                        fill: { color: 'FFFFFF' },
                        border: { pt: 2, color: '000000' }
                    });
                    posIndex++;
                });

                pptx.writeFile({ fileName: 'UFLI_Lesson_10_Letter_Tiles.pptx' });
            } catch (e) {
                logError('Letter tiles generation error: ' + e.message);
            }
        }

        // Initialize on page load
        window.onload = checkLibraryLoaded;
    </script>
</body>
</html>
